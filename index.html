<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>WinBeta | Premium Marketplace</title>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Clash+Display:wght@500;600;700&family=General+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root {
            --bg: #0B1120; --card: #1E293B; --pool: #10B981; --auction: #F59E0B;   
            --buy: #3B82F6; --text: #F8FAFC; --text-dim: #94A3B8; --danger: #EF4444;
            --nav-height: 70px;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; outline: none; user-select: none; }

        body {
            font-family: 'General Sans', sans-serif; background-color: var(--bg); color: var(--text);
            padding-bottom: calc(var(--nav-height) + 20px); padding-top: 40px; overflow-x: hidden;
        }

        h1, h2, h3, .brand-font { font-family: 'Clash Display', sans-serif; }
        button { cursor: pointer; font-family: inherit; transition: transform 0.1s; }
        button:active { transform: scale(0.95); }

        /* --- TICKER --- */
        .ticker-wrap {
            position: fixed; top: 0; left: 0; width: 100%; height: 35px;
            background: var(--pool); overflow: hidden; z-index: 100;
            display: flex; align-items: center; border-bottom: 2px solid #065f46;
        }
        .ticker { display: flex; white-space: nowrap; animation: ticker 30s linear infinite; }
        .ticker-item { padding: 0 20px; color: #022c22; font-weight: 700; font-size: 0.8rem; }
        @keyframes ticker { 0% { transform: translateX(0); } 100% { transform: translateX(-100%); } }

        /* --- HEADER --- */
        header {
            padding: 15px 20px; display: flex; justify-content: space-between; align-items: center;
            position: sticky; top: 35px; z-index: 90; background: rgba(11, 17, 32, 0.95);
            backdrop-filter: blur(10px); border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        .brand { font-size: 1.5rem; font-weight: 700; color: white; }
        .brand span { color: var(--pool); }
        
        .wallet-pill {
            background: #334155; padding: 8px 14px; border-radius: 30px; font-weight: 700; font-size: 0.85rem;
            display: flex; align-items: center; gap: 8px; border: 1px solid #475569; cursor: pointer;
        }

        /* --- FEED GRID --- */
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(165px, 1fr)); gap: 15px; padding: 0 20px; }
        .card {
            background: var(--card); border-radius: 16px; overflow: hidden; position: relative;
            border: 1px solid rgba(255,255,255,0.05); box-shadow: 0 4px 20px rgba(0,0,0,0.2);
            transition: transform 0.2s; cursor: pointer;
        }
        .card:active { transform: scale(0.98); }
        .card-badge {
            position: absolute; top: 10px; left: 10px; padding: 4px 10px; border-radius: 6px; 
            font-size: 0.65rem; font-weight: 800; text-transform: uppercase; z-index: 10;
        }
        .badge-pool { background: var(--pool); color: #022c22; }
        .badge-auction { background: var(--auction); color: #451a03; animation: pulse 1.5s infinite; }
        .badge-buy { background: var(--buy); color: white; }
        .card-img { width: 100%; height: 150px; object-fit: cover; background: #0f172a; }
        .card-body { padding: 12px; }
        .card-title { font-size: 0.9rem; font-weight: 600; margin-bottom: 5px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .mode-info { display: flex; justify-content: space-between; align-items: center; font-size: 0.75rem; color: var(--text-dim); margin-bottom: 8px; }
        .price-lg { font-size: 1.1rem; font-weight: 700; color: white; }

        /* --- PRODUCT VIEW PAGE (New) --- */
        #product-view {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--bg); z-index: 150; overflow-y: auto;
            padding-bottom: 90px; /* Space for sticky footer */
            display: none; animation: slideInRight 0.3s ease;
        }
        @keyframes slideInRight { from { transform: translateX(100%); } to { transform: translateX(0); } }

        .pv-header {
            position: sticky; top: 0; background: rgba(11,17,32,0.9); backdrop-filter: blur(10px);
            padding: 15px 20px; display: flex; justify-content: space-between; align-items: center; z-index: 10;
            border-bottom: 1px solid #334155;
        }
        .pv-hero { width: 100%; height: 300px; object-fit: cover; }
        .pv-body { padding: 20px; }
        .pv-title { font-size: 1.5rem; font-weight: 700; margin-bottom: 10px; font-family: 'Clash Display'; }
        .pv-price { font-size: 1.8rem; font-weight: 700; color: var(--pool); margin-bottom: 15px; }
        .pv-meta { display: flex; gap: 15px; margin-bottom: 20px; }
        .pv-tag { background: #1e293b; padding: 5px 12px; border-radius: 6px; font-size: 0.8rem; color: var(--text-dim); display: flex; align-items: center; gap: 5px; border: 1px solid #334155; }

        .seller-card {
            display: flex; align-items: center; gap: 12px; background: #1e293b; padding: 12px; 
            border-radius: 12px; margin-bottom: 25px; border: 1px solid #334155;
        }
        .seller-avatar { width: 40px; height: 40px; border-radius: 50%; background: #334155; }
        
        /* Activity Feed in Product View */
        .activity-section { margin-top: 25px; }
        .act-header { font-weight: 700; margin-bottom: 15px; display: flex; justify-content: space-between; }
        .act-row { display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid #1e293b; }
        .act-user { display: flex; gap: 10px; align-items: center; font-weight: 600; font-size: 0.9rem; }
        .act-time { font-size: 0.75rem; color: var(--text-dim); }
        .act-val { font-weight: 700; color: var(--pool); }

        .pv-footer {
            position: fixed; bottom: 0; left: 0; width: 100%; padding: 15px 20px;
            background: #1e293b; border-top: 1px solid #334155; z-index: 160;
            display: flex; gap: 15px; align-items: center;
        }

        /* --- MODAL (Checkout) --- */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85);
            z-index: 200; display: none; align-items: flex-end; backdrop-filter: blur(5px);
        }
        .modal-sheet {
            background: #1e293b; width: 100%; border-radius: 24px 24px 0 0; padding: 25px;
            border-top: 1px solid #334155; animation: slideUp 0.3s; box-shadow: 0 -10px 40px rgba(0,0,0,0.5);
        }
        
        /* --- UTILS --- */
        .input-dark { width: 100%; background: #0f172a; border: 1px solid #334155; color: white; padding: 15px; border-radius: 12px; font-size: 1rem; margin-bottom: 15px; }
        .action-btn { width: 100%; padding: 14px; border: none; border-radius: 12px; font-weight: 700; font-size: 1rem; box-shadow: 0 4px 10px rgba(0,0,0,0.3); display: flex; justify-content: center; align-items: center; gap: 10px;}
        .btn-pool { background: var(--pool); color: #022c22; }
        .btn-auction { background: var(--auction); color: #451a03; }
        .btn-buy { background: var(--buy); color: white; }

        /* Toast & Confetti */
        .toast-container { position: fixed; top: 80px; left: 50%; transform: translateX(-50%); z-index: 300; width: 90%; max-width: 350px; }
        .toast { background: #1e293b; border: 1px solid #334155; padding: 15px; border-radius: 12px; display: flex; align-items: center; gap: 12px; margin-bottom: 10px; box-shadow: 0 10px 25px rgba(0,0,0,0.5); animation: dropIn 0.4s forwards; }
        .toast.success { border-left: 4px solid var(--pool); }
        .toast.error { border-left: 4px solid var(--danger); }
        @keyframes dropIn { from { opacity: 0; transform: translateY(-20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
        #confetti-canvas { position: fixed; top: 0; left: 0; pointer-events: none; z-index: 999; }

        .page { display: none; }
        .page.active { display: block; animation: fadeIn 0.3s; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        
        /* Nav */
        .nav { position: fixed; bottom: 0; left: 0; width: 100%; background: #0f172a; height: var(--nav-height); display: flex; justify-content: space-around; align-items: center; border-top: 1px solid #334155; z-index: 100; }
        .nav-item { color: #64748b; text-align: center; font-size: 0.7rem; flex: 1; }
        .nav-item.active { color: white; }
        .nav-fab { width: 50px; height: 50px; background: white; color: black; border-radius: 50%; display: grid; place-items: center; font-size: 1.5rem; margin-top: -25px; box-shadow: 0 5px 15px rgba(255,255,255,0.2); }

    </style>
</head>
<body>

    <canvas id="confetti-canvas"></canvas>
    <div class="toast-container" id="toast-container"></div>

    <!-- TICKER -->
    <div class="ticker-wrap">
        <div class="ticker">
            <div class="ticker-item">üî• Ahmed just bid ‚Ç¶45,000</div>
            <div class="ticker-item">üèÜ Grace won iPhone 14</div>
            <div class="ticker-item">üí∞ New Auction: Camry 2018</div>
            <div class="ticker-item">üõí Emeka bought Generator</div>
        </div>
    </div>

    <!-- HEADER -->
    <header id="main-header">
        <div class="brand">Win<span>Beta</span></div>
        <div class="wallet-pill" onclick="addFunds()">
            <i class="fa-solid fa-wallet" style="color:var(--pool)"></i> 
            <span id="wallet-display">‚Ç¶54,000</span>
        </div>
    </header>

    <main>
        <!-- HOME FEED -->
        <section id="home" class="page active">
            <div style="padding: 0 20px 15px 20px; overflow-x:auto; display:flex; gap:10px;">
                <button class="action-btn" style="width:auto; padding:8px 15px; background:var(--text); color:var(--bg); font-size:0.8rem;" onclick="renderFeed(items)">All</button>
                <button class="action-btn" style="width:auto; padding:8px 15px; background:#1e293b; color:var(--text-dim); border:1px solid #334155; font-size:0.8rem;" onclick="renderFeed(items.filter(i=>i.type==='pool'))">Pools</button>
                <button class="action-btn" style="width:auto; padding:8px 15px; background:#1e293b; color:var(--text-dim); border:1px solid #334155; font-size:0.8rem;" onclick="renderFeed(items.filter(i=>i.type==='auction'))">Auctions</button>
            </div>

            <div class="grid" id="feed-container"></div>
            <div style="height: 80px;"></div>
        </section>

        <!-- PRODUCT DETAIL VIEW -->
        <section id="product-view">
            <div class="pv-header">
                <i class="fa-solid fa-arrow-left" style="font-size:1.2rem; cursor:pointer;" onclick="closeProductView()"></i>
                <div style="font-weight:700;">Item Details</div>
                <i class="fa-regular fa-heart" style="font-size:1.2rem;"></i>
            </div>

            <img id="pv-img" class="pv-hero" src="">
            
            <div class="pv-body">
                <h1 id="pv-title" class="pv-title">Product Name</h1>
                <div id="pv-price" class="pv-price">‚Ç¶0.00</div>
                
                <div class="pv-meta">
                    <div class="pv-tag"><i class="fa-solid fa-eye" style="color:var(--pool)"></i> <span id="pv-views">24</span> Viewing</div>
                    <div class="pv-tag"><i class="fa-solid fa-truck"></i> Fast Delivery</div>
                </div>

                <div class="seller-card">
                    <img src="https://i.pravatar.cc/100?img=33" class="seller-avatar">
                    <div>
                        <div style="font-weight:700; font-size:0.9rem;">GadgetWorld Ltd <i class="fa-solid fa-circle-check" style="color:var(--buy)"></i></div>
                        <div style="font-size:0.75rem; color:var(--text-dim);">Verified Merchant ‚Ä¢ 98% Positive</div>
                    </div>
                </div>

                <div style="color: #cbd5e1; line-height: 1.6; font-size: 0.9rem; margin-bottom:30px;">
                    This item is currently trending. It comes with a 1-year warranty and full accessories. 
                    <span id="pv-desc-extra">Condition is brand new sealed in box.</span>
                </div>

                <!-- Dynamic Activity Section -->
                <div class="activity-section">
                    <div class="act-header">
                        <span id="act-label">Recent Activity</span>
                        <span style="font-size:0.8rem; color:var(--pool); cursor:pointer;">View All</span>
                    </div>
                    <div id="pv-activity-list">
                        <!-- Injected JS -->
                    </div>
                </div>
            </div>

            <div class="pv-footer" id="pv-footer">
                <!-- Dynamic CTA -->
            </div>
        </section>

    </main>

    <!-- CHECKOUT MODAL -->
    <div class="modal-overlay" id="modal" onclick="if(event.target === this) closeModal()">
        <div class="modal-sheet">
            <div style="display:flex; justify-content:space-between; margin-bottom:15px;">
                <h3 id="m-title">Confirm Action</h3>
                <i class="fa-solid fa-times" onclick="closeModal()"></i>
            </div>
            <div id="m-content"></div>
        </div>
    </div>

    <!-- NAV -->
    <nav class="nav" id="main-nav">
        <div class="nav-item active" onclick="navHome()"><i class="fa-solid fa-home"></i>Home</div>
        <div class="nav-item"><i class="fa-solid fa-search"></i>Search</div>
        <div class="nav-item"><div class="nav-fab"><i class="fa-solid fa-plus"></i></div></div>
        <div class="nav-item"><i class="fa-solid fa-bell"></i>Alerts</div>
        <div class="nav-item"><i class="fa-regular fa-user"></i>Profile</div>
    </nav>

    <script>
        let walletBalance = 54000;
        let currentItem = null;

        // Extended Data with Activity Logs
        const items = [
            { 
                id: 1, type: 'pool', name: 'iPhone 15 Pro Max', img: 'https://images.unsplash.com/photo-1695048133142-1a20484d2569?w=600',
                ticketPrice: 1000, sold: 850, total: 1000,
                activity: [
                    { user: 'Davido_01', time: '2m ago', val: 'Bought 10 Tickets' },
                    { user: 'Sarah_J', time: '5m ago', val: 'Bought 2 Tickets' },
                    { user: 'Musa_K', time: '12m ago', val: 'Bought 5 Tickets' }
                ]
            },
            { 
                id: 2, type: 'auction', name: 'Vintage Rolex Watch', img: 'https://images.unsplash.com/photo-1524592094714-0f0654e20314?w=600',
                currentBid: 45000, bids: 12, ends: 3600, bidder: 'Chief_Obi',
                activity: [
                    { user: 'Chief_Obi', time: '1m ago', val: 'Bid ‚Ç¶45,000' },
                    { user: 'WatchCollector', time: '15m ago', val: 'Bid ‚Ç¶42,000' },
                    { user: 'Lagos_Boy', time: '32m ago', val: 'Bid ‚Ç¶40,000' }
                ]
            },
            { 
                id: 3, type: 'buynow', name: 'UK Used HP Laptop', img: 'https://images.unsplash.com/photo-1496181133206-80ce9b88a853?w=600',
                price: 120000, original: 150000,
                activity: [
                    { user: 'Student_22', time: '2h ago', val: 'Viewed Item' },
                    { user: 'Tech_Bro', time: '5h ago', val: 'Added to Cart' }
                ]
            },
            { 
                id: 5, type: 'auction', name: 'Sony PS5 Slim', img: 'https://images.unsplash.com/photo-1606144042614-b2417e99c4e3?w=600',
                currentBid: 85000, bids: 28, ends: 1200, bidder: 'Gamer_X',
                activity: [
                    { user: 'Gamer_X', time: '30s ago', val: 'Bid ‚Ç¶85,000' },
                    { user: 'NoobMaster', time: '4m ago', val: 'Bid ‚Ç¶82,500' }
                ]
            }
        ];

        window.onload = () => { 
            renderFeed(items);
            initConfetti();
        };

        function updateWallet() { document.getElementById('wallet-display').innerText = `‚Ç¶${walletBalance.toLocaleString()}`; }
        function addFunds() { walletBalance += 50000; updateWallet(); showToast('Deposited ‚Ç¶50,000', 'success'); triggerConfetti(); }

        // --- RENDER FEED ---
        function renderFeed(data) {
            const container = document.getElementById('feed-container');
            container.innerHTML = '';
            data.forEach(item => {
                let badge = item.type === 'pool' ? `<div class="card-badge badge-pool">POOL</div>` : 
                            item.type === 'auction' ? `<div class="card-badge badge-auction">LIVE</div>` : 
                            `<div class="card-badge badge-buy">SALE</div>`;
                
                let sub = item.type === 'pool' ? `‚Ç¶${item.ticketPrice}/ticket` : 
                          item.type === 'auction' ? `Current: ‚Ç¶${item.currentBid.toLocaleString()}` : 
                          `‚Ç¶${item.price.toLocaleString()}`;

                container.innerHTML += `
                    <div class="card" onclick="openProductPage(${item.id})">
                        ${badge}
                        <img src="${item.img}" class="card-img">
                        <div class="card-body">
                            <div class="card-title">${item.name}</div>
                            <div class="price-lg" style="font-size:1rem;">${sub}</div>
                            <div style="font-size:0.7rem; color:var(--text-dim); margin-top:5px;">Tap for details</div>
                        </div>
                    </div>`;
            });
        }

        // --- PRODUCT PAGE LOGIC ---
        function openProductPage(id) {
            currentItem = items.find(i => i.id === id);
            if(!currentItem) return;

            // UI Elements
            document.getElementById('pv-img').src = currentItem.img;
            document.getElementById('pv-title').innerText = currentItem.name;
            document.getElementById('pv-views').innerText = Math.floor(Math.random() * 30) + 10;

            // Mode Specifics
            const priceEl = document.getElementById('pv-price');
            const actList = document.getElementById('pv-activity-list');
            const footer = document.getElementById('pv-footer');
            const label = document.getElementById('act-label');
            
            actList.innerHTML = '';

            if(currentItem.type === 'pool') {
                priceEl.innerHTML = `‚Ç¶${currentItem.ticketPrice} <span style="font-size:1rem; color:#94A3B8">/ ticket</span>`;
                label.innerText = "Recent Ticket Buyers";
                footer.innerHTML = `<button class="action-btn btn-pool" onclick="openCheckoutModal()">Join Pool Now</button>`;
                
                // Simulate activity if empty
                currentItem.activity.forEach(log => {
                    actList.innerHTML += createActivityRow(log.user, log.time, log.val, 'ticket');
                });
            } 
            else if (currentItem.type === 'auction') {
                priceEl.innerHTML = `<span style="font-size:0.9rem; color:#F59E0B">Current Bid:</span> ‚Ç¶${currentItem.currentBid.toLocaleString()}`;
                label.innerText = "Live Bidding History";
                footer.innerHTML = `<button class="action-btn btn-auction" onclick="openCheckoutModal()">Place Bid</button>`;
                
                currentItem.activity.forEach(log => {
                    actList.innerHTML += createActivityRow(log.user, log.time, log.val, 'gavel');
                });
            } 
            else {
                priceEl.innerHTML = `‚Ç¶${currentItem.price.toLocaleString()}`;
                label.innerText = "Shopper Activity";
                footer.innerHTML = `<button class="action-btn btn-buy" onclick="openCheckoutModal()">Buy Now</button>`;
                
                currentItem.activity.forEach(log => {
                    actList.innerHTML += createActivityRow(log.user, log.time, log.val, 'bag-shopping');
                });
            }

            // Show Page
            document.getElementById('product-view').style.display = 'block';
            document.getElementById('main-nav').style.display = 'none'; // Hide bottom nav for immersion
            if(navigator.vibrate) navigator.vibrate(10);
        }

        function createActivityRow(user, time, val, icon) {
            return `
                <div class="act-row">
                    <div class="act-user">
                        <div style="width:30px; height:30px; background:#334155; border-radius:50%; display:grid; place-items:center; font-size:0.8rem;">
                            <i class="fa-solid fa-${icon}" style="color:#cbd5e1"></i>
                        </div>
                        <div>
                            <div>${user}</div>
                            <div class="act-time">${time}</div>
                        </div>
                    </div>
                    <div class="act-val">${val}</div>
                </div>
            `;
        }

        function closeProductView() {
            document.getElementById('product-view').style.display = 'none';
            document.getElementById('main-nav').style.display = 'flex';
        }

        function navHome() {
            closeProductView();
            document.getElementById('home').classList.add('active');
        }

        // --- CHECKOUT MODAL LOGIC (Simplified Reuse) ---
        function openCheckoutModal() {
            const content = document.getElementById('m-content');
            document.getElementById('m-title').innerText = currentItem.name;
            
            // Simply reuse logic based on type
            if (currentItem.type === 'pool') {
                content.innerHTML = `
                    <p style="color:#94A3B8; margin-bottom:15px;">How many tickets?</p>
                    <div style="display:flex; gap:10px; margin-bottom:20px;">
                        <button class="action-btn" style="background:#334155; color:white;" onclick="processTransaction(1)">1 (‚Ç¶${currentItem.ticketPrice})</button>
                        <button class="action-btn btn-pool" onclick="processTransaction(5)">5 (‚Ç¶${currentItem.ticketPrice*5})</button>
                    </div>`;
            } else if (currentItem.type === 'auction') {
                const min = currentItem.currentBid + 1000;
                content.innerHTML = `
                    <div style="text-align:center; margin-bottom:15px; color:#F59E0B">Min Bid: ‚Ç¶${min.toLocaleString()}</div>
                    <input type="number" id="bid-amount" class="input-dark" value="${min}">
                    <button class="action-btn btn-auction" onclick="processTransaction('bid')">Confirm Bid</button>
                `;
            } else {
                content.innerHTML = `
                    <div style="display:flex; justify-content:space-between; margin-bottom:20px;">
                        <span>Total with Delivery:</span>
                        <span style="font-weight:700; color:var(--buy)">‚Ç¶${(currentItem.price + 2000).toLocaleString()}</span>
                    </div>
                    <button class="action-btn btn-buy" onclick="processTransaction('buy')">Pay Securely</button>
                `;
            }
            document.getElementById('modal').style.display = 'flex';
        }

        function processTransaction(type) {
            let cost = 0;
            let msg = "";

            if(currentItem.type === 'pool') {
                cost = currentItem.ticketPrice * type;
                msg = `Bought ${type} tickets!`;
                // Fake add to activity list
                currentItem.activity.unshift({user: 'You', time: 'Just now', val: `Bought ${type} Tickets`});
            } 
            else if (currentItem.type === 'auction') {
                const bidVal = parseInt(document.getElementById('bid-amount').value);
                if(bidVal <= currentItem.currentBid) return showToast("Bid too low", "error");
                cost = bidVal; // In real app, we might just hold
                currentItem.currentBid = bidVal;
                msg = "Bid Placed Successfully!";
                currentItem.activity.unshift({user: 'You', time: 'Just now', val: `Bid ‚Ç¶${bidVal.toLocaleString()}`});
            }
            else {
                cost = currentItem.price + 2000;
                msg = "Order Placed!";
            }

            if(walletBalance >= cost) {
                walletBalance -= cost;
                updateWallet();
                closeModal();
                showToast(msg, "success");
                triggerConfetti();
                // Refresh View
                openProductPage(currentItem.id);
            } else {
                showToast("Insufficient Funds", "error");
            }
        }

        function closeModal() { document.getElementById('modal').style.display = 'none'; }
        function showToast(m, t) {
            const c = document.getElementById('toast-container');
            const d = document.createElement('div'); d.className=`toast ${t}`; d.innerText=m;
            c.appendChild(d); setTimeout(()=>d.remove(),3000);
        }

        // Confetti Engine
        const cvs = document.getElementById("confetti-canvas"); const ctx = cvs.getContext("2d");
        let parts = [];
        function initConfetti() { cvs.width=window.innerWidth; cvs.height=window.innerHeight; }
        function triggerConfetti() {
            for(let i=0; i<100; i++) parts.push({x:cvs.width/2, y:cvs.height/2, vx:(Math.random()-0.5)*10, vy:(Math.random()-0.5)*10, c:`hsl(${Math.random()*360},100%,50%)`, l:100});
            animate();
        }
        function animate() {
            if(!parts.length) return;
            ctx.clearRect(0,0,cvs.width,cvs.height);
            parts.forEach((p,i)=>{ p.x+=p.vx; p.y+=p.vy; p.l--; ctx.fillStyle=p.c; ctx.fillRect(p.x,p.y,5,5); if(p.l<=0) parts.splice(i,1); });
            requestAnimationFrame(animate);
        }
    </script>
</body>
</html>
