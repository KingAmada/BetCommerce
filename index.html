<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>WinBeta | The Super App</title>
    <link href="https://fonts.googleapis.com/css2?family=Clash+Display:wght@500;600;700&family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Root variables section - expanded with more color variants and dimensions */
        :root {
            --bg: #020617;
            --surface: #0f172a;
            --surface-2: #1e293b;
            --surface-3: #2d3a4e; /* Added for depth in layering */
            --border: #334155;
            --border-light: #475569; /* Lighter border for subtle elements */
            --primary: #10B981;
            --primary-dim: rgba(16, 185, 129, 0.1);
            --primary-dark: #059669; /* Darker primary for hover states */
            --accent: #F59E0B;
            --accent-dim: rgba(245, 158, 11, 0.1);
            --danger: #EF4444;
            --danger-dim: rgba(239, 68, 68, 0.1);
            --info: #3B82F6;
            --info-dim: rgba(59, 130, 246, 0.1);
            --success: #22C55E;
            --warning: #EAB308;
            --secondary: #64748B;
            --text: #F8FAFC;
            --text-muted: #94A3B8;
            --text-dim: #CBD5E1; /* Dim text for secondary info */
            --nav-height: 72px;
            --header-height: 60px;
            --footer-height: 50px; /* Added for potential footer */
            --sidebar-width: 250px; /* For possible sidebar layouts */
            --ease: cubic-bezier(0.23, 1, 0.32, 1);
            --ease-in: cubic-bezier(0.42, 0, 1, 1);
            --ease-out: cubic-bezier(0, 0, 0.58, 1);
            --shadow-sm: 0 1px 2px rgba(0,0,0,0.05);
            --shadow-md: 0 4px 6px rgba(0,0,0,0.1);
            --shadow-lg: 0 10px 15px rgba(0,0,0,0.2);
            --shadow-xl: 0 20px 25px rgba(0,0,0,0.25);
            --font-size-xs: 0.75rem;
            --font-size-sm: 0.875rem;
            --font-size-base: 1rem;
            --font-size-lg: 1.125rem;
            --font-size-xl: 1.25rem;
            --font-size-2xl: 1.5rem;
            --font-size-3xl: 1.875rem;
            --font-size-4xl: 2.25rem;
            --border-radius-sm: 4px;
            --border-radius-md: 6px;
            --border-radius-lg: 8px;
            --border-radius-xl: 12px;
            --border-radius-2xl: 16px;
            --border-radius-full: 9999px;
            --transition-fast: 150ms ease;
            --transition-normal: 300ms ease;
            --transition-slow: 500ms ease;
            --z-index-nav: 1000;
            --z-index-modal: 2000;
            --z-index-toast: 3000;
            --z-index-tooltip: 4000;
            --overlay-bg: rgba(2,6,23,0.8);
            --gradient-primary: linear-gradient(to right, var(--primary), var(--info));
            --gradient-accent: linear-gradient(to right, var(--accent), var(--warning));
            --gradient-danger: linear-gradient(to right, var(--danger), #B91C1C);
        }

        /* Global resets and base styles */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            -webkit-tap-highlight-color: transparent;
            outline: none;
            user-select: none;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background: var(--bg);
            color: var(--text);
            overflow: hidden;
            height: 100vh;
            width: 100vw;
            font-size: var(--font-size-base);
            line-height: 1.5;
        }

        a {
            text-decoration: none;
            color: inherit;
        }

        button {
            cursor: pointer;
        }

        input, textarea, select {
            font-family: inherit;
        }

        /* Headings and brand styles */
        h1, h2, h3, h4, h5, h6, .brand {
            font-family: 'Clash Display', sans-serif;
            font-weight: 700;
        }

        h1 {
            font-size: var(--font-size-4xl);
        }

        h2 {
            font-size: var(--font-size-3xl);
        }

        h3 {
            font-size: var(--font-size-2xl);
        }

        h4 {
            font-size: var(--font-size-xl);
        }

        h5 {
            font-size: var(--font-size-lg);
        }

        h6 {
            font-size: var(--font-size-base);
        }

        /* Utility classes - expanded significantly */
        .hidden {
            display: none !important;
        }

        .block {
            display: block;
        }

        .inline-block {
            display: inline-block;
        }

        .flex {
            display: flex;
        }

        .flex-center {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .flex-between {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .flex-around {
            display: flex;
            align-items: center;
            justify-content: space-around;
        }

        .flex-column {
            display: flex;
            flex-direction: column;
        }

        .flex-column-center {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .grid {
            display: grid;
        }

        .grid-2 {
            grid-template-columns: repeat(2, 1fr);
        }

        .grid-3 {
            grid-template-columns: repeat(3, 1fr);
        }

        .grid-4 {
            grid-template-columns: repeat(4, 1fr);
        }

        .gap-xs {
            gap: 4px;
        }

        .gap-sm {
            gap: 8px;
        }

        .gap-md {
            gap: 16px;
        }

        .gap-lg {
            gap: 24px;
        }

        .gap-xl {
            gap: 32px;
        }

        .scroll-y {
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            height: 100%;
            padding-bottom: 100px;
        }

        .scroll-x {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            width: 100%;
        }

        .no-scroll {
            overflow: hidden;
        }

        .pad {
            padding: 20px;
        }

        .pad-xs {
            padding: 4px;
        }

        .pad-sm {
            padding: 8px;
        }

        .pad-md {
            padding: 16px;
        }

        .pad-lg {
            padding: 24px;
        }

        .pad-xl {
            padding: 32px;
        }

        .pad-top {
            padding-top: 20px;
        }

        .pad-bottom {
            padding-bottom: 20px;
        }

        .pad-left {
            padding-left: 20px;
        }

        .pad-right {
            padding-right: 20px;
        }

        .margin-auto {
            margin: auto;
        }

        .margin-xs {
            margin: 4px;
        }

        .margin-sm {
            margin: 8px;
        }

        .margin-md {
            margin: 16px;
        }

        .margin-lg {
            margin: 24px;
        }

        .margin-xl {
            margin: 32px;
        }

        .margin-top {
            margin-top: 20px;
        }

        .margin-bottom {
            margin-bottom: 20px;
        }

        .margin-left {
            margin-left: 20px;
        }

        .margin-right {
            margin-right: 20px;
        }

        .text-gradient {
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .text-gradient-accent {
            background: var(--gradient-accent);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .text-center {
            text-align: center;
        }

        .text-left {
            text-align: left;
        }

        .text-right {
            text-align: right;
        }

        .text-justify {
            text-align: justify;
        }

        .font-bold {
            font-weight: 700;
        }

        .font-semibold {
            font-weight: 600;
        }

        .font-medium {
            font-weight: 500;
        }

        .font-regular {
            font-weight: 400;
        }

        .font-light {
            font-weight: 300;
        }

        .text-xs {
            font-size: var(--font-size-xs);
        }

        .text-sm {
            font-size: var(--font-size-sm);
        }

        .text-base {
            font-size: var(--font-size-base);
        }

        .text-lg {
            font-size: var(--font-size-lg);
        }

        .text-xl {
            font-size: var(--font-size-xl);
        }

        .text-2xl {
            font-size: var(--font-size-2xl);
        }

        .text-3xl {
            font-size: var(--font-size-3xl);
        }

        .text-4xl {
            font-size: var(--font-size-4xl);
        }

        .text-primary {
            color: var(--primary);
        }

        .text-accent {
            color: var(--accent);
        }

        .text-danger {
            color: var(--danger);
        }

        .text-info {
            color: var(--info);
        }

        .text-success {
            color: var(--success);
        }

        .text-warning {
            color: var(--warning);
        }

        .text-muted {
            color: var(--text-muted);
        }

        .bg-primary {
            background: var(--primary);
        }

        .bg-accent {
            background: var(--accent);
        }

        .bg-danger {
            background: var(--danger);
        }

        .bg-info {
            background: var(--info);
        }

        .bg-success {
            background: var(--success);
        }

        .bg-warning {
            background: var(--warning);
        }

        .bg-surface {
            background: var(--surface);
        }

        .bg-surface-2 {
            background: var(--surface-2);
        }

        .border-primary {
            border-color: var(--primary);
        }

        .border-accent {
            border-color: var(--accent);
        }

        .border-danger {
            border-color: var(--danger);
        }

        .border-info {
            border-color: var(--info);
        }

        .border-success {
            border-color: var(--success);
        }

        .border-warning {
            border-color: var(--warning);
        }

        .rounded-sm {
            border-radius: var(--border-radius-sm);
        }

        .rounded-md {
            border-radius: var(--border-radius-md);
        }

        .rounded-lg {
            border-radius: var(--border-radius-lg);
        }

        .rounded-xl {
            border-radius: var(--border-radius-xl);
        }

        .rounded-2xl {
            border-radius: var(--border-radius-2xl);
        }

        .rounded-full {
            border-radius: var(--border-radius-full);
        }

        .shadow-sm {
            box-shadow: var(--shadow-sm);
        }

        .shadow-md {
            box-shadow: var(--shadow-md);
        }

        .shadow-lg {
            box-shadow: var(--shadow-lg);
        }

        .shadow-xl {
            box-shadow: var(--shadow-xl);
        }

        .opacity-0 {
            opacity: 0;
        }

        .opacity-25 {
            opacity: 0.25;
        }

        .opacity-50 {
            opacity: 0.5;
        }

        .opacity-75 {
            opacity: 0.75;
        }

        .opacity-100 {
            opacity: 1;
        }

        .pointer {
            cursor: pointer;
        }

        .no-pointer {
            cursor: default;
        }

        .relative {
            position: relative;
        }

        .absolute {
            position: absolute;
        }

        .fixed {
            position: fixed;
        }

        .sticky {
            position: sticky;
        }

        .top-0 {
            top: 0;
        }

        .bottom-0 {
            bottom: 0;
        }

        .left-0 {
            left: 0;
        }

        .right-0 {
            right: 0;
        }

        .z-10 {
            z-index: 10;
        }

        .z-20 {
            z-index: 20;
        }

        .z-30 {
            z-index: 30;
        }

        .z-40 {
            z-index: 40;
        }

        .z-50 {
            z-index: 50;
        }

        /* Animations - expanded with more keyframes */
        @keyframes slideIn {
            from {
                transform: translateX(100%);
            }
            to {
                transform: translateX(0);
            }
        }

        @keyframes slideOut {
            from {
                transform: translateX(0);
            }
            to {
                transform: translateX(100%);
            }
        }

        @keyframes fadeUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
            100% {
                transform: scale(1);
            }
        }

        @keyframes bounce {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-10px);
            }
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        @keyframes fadeOut {
            from {
                opacity: 1;
            }
            to {
                opacity: 0;
            }
        }

        @keyframes scaleUp {
            from {
                transform: scale(0.95);
            }
            to {
                transform: scale(1);
            }
        }

        @keyframes scaleDown {
            from {
                transform: scale(1);
            }
            to {
                transform: scale(0.95);
            }
        }

        @keyframes rotate {
            from {
                transform: rotate(0deg);
            }
            to {
                transform: rotate(360deg);
            }
        }

        @keyframes glow {
            0% {
                box-shadow: 0 0 5px var(--primary-dim);
            }
            50% {
                box-shadow: 0 0 20px var(--primary-dim);
            }
            100% {
                box-shadow: 0 0 5px var(--primary-dim);
            }
        }

        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            50% { transform: translateX(5px); }
            75% { transform: translateX(-5px); }
            100% { transform: translateX(0); }
        }

        @keyframes slideLeft {
            from { transform: translateX(50%); }
            to { transform: translateX(0); }
        }

        @keyframes slideRight {
            from { transform: translateX(-50%); }
            to { transform: translateX(0); }
        }

        /* Animation utility classes */
        .animate-slide-in {
            animation: slideIn var(--transition-normal) var(--ease);
        }

        .animate-fade-up {
            animation: fadeUp var(--transition-normal) var(--ease);
        }

        .animate-pulse {
            animation: pulse 1s infinite;
        }

        .animate-bounce {
            animation: bounce 1s infinite;
        }

        .animate-spin {
            animation: spin 1s linear infinite;
        }

        .animate-fade-in {
            animation: fadeIn var(--transition-fast);
        }

        .animate-scale-up {
            animation: scaleUp var(--transition-normal);
        }

        .animate-glow {
            animation: glow 2s infinite;
        }

        .animate-shake {
            animation: shake 0.5s;
        }

        /* Components - expanded with more button variants, inputs, etc. */
        .btn {
            width: 100%;
            padding: 16px;
            border-radius: var(--border-radius-lg);
            font-weight: 600;
            font-size: var(--font-size-base);
            border: none;
            cursor: pointer;
            transition: transform var(--transition-fast), background var(--transition-fast);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .btn:hover {
            opacity: 0.9;
        }

        .btn:active {
            transform: scale(0.96);
        }

        .btn-primary {
            background: var(--primary);
            color: #000;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
        }

        .btn-outline {
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text);
        }

        .btn-outline:hover {
            background: var(--surface-2);
        }

        .btn-danger {
            background: var(--danger-dim);
            color: var(--danger);
        }

        .btn-danger:hover {
            background: var(--danger);
            color: var(--text);
        }

        .btn-success {
            background: var(--success);
            color: #000;
        }

        .btn-warning {
            background: var(--warning);
            color: #000;
        }

        .btn-info {
            background: var(--info);
            color: var(--text);
        }

        .btn-secondary {
            background: var(--secondary);
            color: var(--text);
        }

        .btn-sm {
            padding: 8px 12px;
            font-size: var(--font-size-sm);
        }

        .btn-lg {
            padding: 20px;
            font-size: var(--font-size-lg);
        }

        .btn-icon {
            width: auto;
            padding: 10px;
            border-radius: var(--border-radius-full);
        }

        .btn-disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .input-group {
            margin-bottom: 15px;
            position: relative;
        }

        .input-field {
            width: 100%;
            background: var(--surface);
            border: 1px solid var(--border);
            color: var(--text);
            padding: 16px;
            border-radius: var(--border-radius-lg);
            font-size: var(--font-size-base);
            transition: border-color var(--transition-normal), box-shadow var(--transition-normal);
            font-family: inherit;
        }

        .input-field:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 4px var(--primary-dim);
        }

        .input-field::placeholder {
            color: var(--text-muted);
        }

        .input-label {
            position: absolute;
            top: -8px;
            left: 12px;
            background: var(--bg);
            padding: 0 5px;
            font-size: var(--font-size-sm);
            color: var(--text-muted);
            transition: color var(--transition-fast);
        }

        .input-field:focus + .input-label {
            color: var(--primary);
        }

        .input-error {
            border-color: var(--danger);
        }

        .input-success {
            border-color: var(--success);
        }

        .input-disabled {
            background: var(--surface-2);
            color: var(--text-muted);
            cursor: not-allowed;
        }

        .textarea {
            min-height: 100px;
            resize: vertical;
        }

        .select {
            appearance: none;
            background-image: url("data:image/svg+xml;utf8,<svg fill='var(--text-muted)' height='24' viewBox='0 0 24 24' width='24' xmlns='http://www.w3.org/2000/svg'><path d='M7 10l5 5 5-5z'/><path d='M0 0h24v24H0z' fill='none'/></svg>");
            background-repeat: no-repeat;
            background-position-x: 100%;
            background-position-y: 50%;
        }

        /* Layouts */
        #app-root {
            width: 100%;
            height: 100%;
            position: relative;
            overflow: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .view {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--bg);
            z-index: 10;
            display: none;
            flex-direction: column;
        }

        .view.active {
            display: flex;
            animation: fadeUp var(--transition-normal) var(--ease);
        }

        .view.overlay {
            z-index: 50;
            animation: slideIn var(--transition-normal) var(--ease);
        }

        .view-modal {
            z-index: var(--z-index-modal);
            background: var(--overlay-bg);
            backdrop-filter: blur(5px);
        }

        .sidebar {
            width: var(--sidebar-width);
            height: 100%;
            position: fixed;
            left: 0;
            top: 0;
            background: var(--surface);
            border-right: 1px solid var(--border);
            transform: translateX(-100%);
            transition: transform var(--transition-normal);
        }

        .sidebar.active {
            transform: translateX(0);
        }

        /* Auth screen styles */
        .auth-container {
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding: 30px;
            background: radial-gradient(circle at top right, var(--surface-2) 0%, var(--bg) 60%);
        }

        .auth-logo {
            animation: pulse 2s infinite;
        }

        .auth-form {
            margin-top: 40px;
        }

        .auth-footer {
            margin-top: auto;
            text-align: center;
            color: var(--text-muted);
            font-size: var(--font-size-sm);
        }

        /* Main app UI */
        header {
            height: var(--header-height);
            border-bottom: 1px solid var(--border);
            background: var(--overlay-bg);
            backdrop-filter: blur(12px);
            position: sticky;
            top: 0;
            z-index: 40;
        }

        .header-content {
            padding: 0 20px;
        }

        /* Card styles */
        .card {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: var(--border-radius-2xl);
            overflow: hidden;
            margin-bottom: 15px;
            position: relative;
            transition: transform var(--transition-fast), box-shadow var(--transition-fast);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-md);
        }

        .card-img {
            width: 100%;
            height: 180px;
            object-fit: cover;
            background: var(--surface-2);
        }

        .card-body {
            padding: 15px;
        }

        .card-title {
            font-size: var(--font-size-lg);
            margin-bottom: 5px;
        }

        .card-subtitle {
            font-size: var(--font-size-sm);
            color: var(--text-muted);
        }

        .tag {
            position: absolute;
            top: 10px;
            left: 10px;
            padding: 4px 10px;
            border-radius: var(--border-radius-sm);
            font-size: var(--font-size-xs);
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .tag.pool {
            background: var(--primary);
            color: #000;
        }

        .tag.auction {
            background: var(--accent);
            color: #000;
        }

        .tag.buy {
            background: var(--info);
            color: #fff;
        }

        /* Navigation styles */
        .nav-bar {
            height: var(--nav-height);
            background: var(--surface);
            border-top: 1px solid var(--border);
            position: fixed;
            bottom: 0;
            width: 100%;
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            z-index: var(--z-index-nav);
            padding-bottom: env(safe-area-inset-bottom);
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: var(--text-muted);
            transition: color var(--transition-fast);
        }

        .nav-item.active {
            color: var(--primary);
        }

        .nav-item i {
            font-size: 1.4rem;
            margin-bottom: 4px;
        }

        .nav-fab {
            background: var(--text);
            color: var(--bg);
            width: 48px;
            height: 48px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-top: -25px;
            box-shadow: var(--shadow-lg);
            font-size: 1.5rem;
        }

        .nav-label {
            font-size: var(--font-size-xs);
        }

        /* Wallet styles */
        .balance-card {
            background: linear-gradient(135deg, var(--surface-2), var(--surface));
            padding: 25px;
            border-radius: var(--border-radius-xl);
            border: 1px solid var(--border);
            text-align: center;
            margin-bottom: 20px;
            box-shadow: var(--shadow-sm);
        }

        .balance-amount {
            font-size: var(--font-size-3xl);
            font-weight: 700;
        }

        .tx-row {
            display: flex;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid var(--border);
            transition: background var(--transition-fast);
        }

        .tx-row:hover {
            background: var(--surface-2);
        }

        .tx-icon {
            width: 40px;
            height: 40px;
            border-radius: var(--border-radius-md);
            background: var(--surface-2);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-size: 1.2rem;
        }

        .tx-desc {
            flex: 1;
        }

        .tx-time {
            font-size: var(--font-size-xs);
            color: var(--text-muted);
        }

        .tx-amount {
            font-weight: 700;
        }

        /* Profile styles */
        .profile-header {
            text-align: center;
            padding: 30px 0;
        }

        .avatar-lg {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: var(--surface-2);
            margin: 0 auto 15px;
            border: 2px solid var(--primary);
            object-fit: cover;
        }

        .profile-name {
            font-size: var(--font-size-2xl);
        }

        .profile-username {
            color: var(--text-muted);
            font-size: var(--font-size-sm);
        }

        .stat-row {
            display: flex;
            justify-content: space-around;
            margin-bottom: 20px;
        }

        .stat-box {
            text-align: center;
            background: var(--surface);
            padding: 15px;
            border-radius: var(--border-radius-lg);
            width: 30%;
            border: 1px solid var(--border);
            box-shadow: var(--shadow-sm);
        }

        .stat-number {
            font-size: var(--font-size-xl);
            font-weight: 700;
        }

        .stat-label {
            font-size: var(--font-size-sm);
            color: var(--text-muted);
        }

        /* Ticker styles */
        .ticker-wrap {
            background: var(--primary);
            height: 30px;
            display: flex;
            align-items: center;
            overflow: hidden;
        }

        .ticker {
            animation: ticker 20s linear infinite;
            white-space: nowrap;
            display: flex;
        }

        .ticker-item {
            color: #000;
            font-weight: 700;
            font-size: var(--font-size-sm);
            margin-right: 30px;
        }

        @keyframes ticker {
            0% {
                transform: translateX(0);
            }
            100% {
                transform: translateX(-100%);
            }
        }

        /* Toast and Modal styles */
        .modal-wrap {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--overlay-bg);
            z-index: var(--z-index-modal);
            display: none;
            justify-content: center;
            align-items: flex-end;
            backdrop-filter: blur(4px);
        }

        .modal-body {
            background: var(--surface-2);
            width: 100%;
            padding: 25px;
            border-radius: 25px 25px 0 0;
            animation: slideUp var(--transition-normal);
            border-top: 1px solid var(--border);
            max-height: 85vh;
            overflow-y: auto;
        }

        @keyframes slideUp {
            from {
                transform: translateY(100%);
            }
            to {
                transform: translateY(0);
            }
        }

        .toast-container {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: var(--z-index-toast);
            width: 90%;
        }

        .toast {
            background: var(--surface);
            border: 1px solid var(--border);
            padding: 15px;
            border-radius: var(--border-radius-lg);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
            animation: fadeUp var(--transition-normal);
            box-shadow: var(--shadow-lg);
        }

        .toast-icon {
            font-size: var(--font-size-lg);
        }

        .toast-message {
            flex: 1;
        }

        /* Additional component styles */
        .accordion {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: var(--border-radius-lg);
            overflow: hidden;
        }

        .accordion-header {
            padding: 15px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .accordion-content {
            padding: 0 15px 15px;
            display: none;
        }

        .accordion.active .accordion-content {
            display: block;
        }

        .tab-container {
            display: flex;
            border-bottom: 1px solid var(--border);
        }

        .tab-item {
            padding: 10px 20px;
            cursor: pointer;
            color: var(--text-muted);
        }

        .tab-item.active {
            color: var(--primary);
            border-bottom: 2px solid var(--primary);
        }

        .tab-content {
            padding: 20px;
        }

        .progress-bar {
            background: var(--surface-2);
            height: 8px;
            border-radius: var(--border-radius-full);
            overflow: hidden;
        }

        .progress-fill {
            background: var(--primary);
            height: 100%;
            transition: width var(--transition-normal);
        }

        .chip {
            padding: 4px 12px;
            border-radius: var(--border-radius-full);
            background: var(--surface-2);
            font-size: var(--font-size-sm);
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }

        .chip-close {
            cursor: pointer;
        }

        .avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
        }

        .avatar-sm {
            width: 32px;
            height: 32px;
        }

        .avatar-lg {
            width: 64px;
            height: 64px;
        }

        .list-item {
            padding: 15px;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .list-icon {
            font-size: 1.2rem;
        }

        .list-text {
            flex: 1;
        }

        .list-arrow {
            color: var(--text-muted);
        }

        /* Media queries for responsiveness */
        @media (min-width: 768px) {
            .pad {
                padding: 30px;
            }

            .nav-bar {
                width: var(--sidebar-width);
                height: 100vh;
                top: 0;
                left: 0;
                bottom: auto;
                grid-template-columns: 1fr;
                grid-template-rows: repeat(5, auto);
                border-top: none;
                border-right: 1px solid var(--border);
            }

            .nav-item {
                flex-direction: row;
                justify-content: flex-start;
                padding: 15px 20px;
            }

            .nav-fab {
                margin-top: 0;
                margin-left: 20px;
            }

            #app-root {
                margin-left: var(--sidebar-width);
            }
        }

        @media (min-width: 1024px) {
            .container {
                padding: 0 40px;
            }
        }

        /* Custom styles for specific elements */
        .daily-reward {
            background: var(--gradient-accent);
            padding: 15px;
            border-radius: var(--border-radius-lg);
            color: var(--text);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .reward-title {
            font-weight: 700;
        }

        .reward-desc {
            font-size: var(--font-size-sm);
            opacity: 0.9;
        }

        .spin-btn {
            background: var(--text);
            color: var(--accent);
            border: none;
            padding: 8px 15px;
            border-radius: var(--border-radius-full);
            font-weight: 700;
            font-size: var(--font-size-sm);
        }

        .filter-pills {
            display: flex;
            gap: 10px;
            overflow-x: auto;
            padding-bottom: 5px;
        }

        .filter-pill {
            padding: 8px 16px;
            border-radius: var(--border-radius-full);
            background: var(--surface);
            color: var(--text-muted);
            font-size: var(--font-size-sm);
            font-weight: 600;
            white-space: nowrap;
            border: 1px solid var(--border);
            transition: background var(--transition-fast), color var(--transition-fast);
        }

        .filter-pill.active {
            background: var(--text);
            color: var(--bg);
        }

        .seller-info {
            margin: 20px 0;
            padding: 15px;
            background: var(--surface);
            border-radius: var(--border-radius-lg);
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .seller-avatar {
            width: 40px;
            height: 40px;
            background: var(--border);
            border-radius: 50%;
        }

        .seller-name {
            font-weight: 700;
        }

        .seller-verified {
            color: var(--info);
        }

        .seller-desc {
            font-size: var(--font-size-sm);
            color: var(--text-muted);
        }

        /* Loader styles */
        .loader {
            border: 4px solid var(--surface-2);
            border-top: 4px solid var(--primary);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }

        /* Confetti canvas */
        .confetti-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: var(--z-index-toast);
        }

        /* End of style expansions */
    </style>
</head>
<body>

<div id="app-root"></div>

<script>
    /**
     * WinBeta Core OS
     * Version: 2.0 Ultra
     * Architecture: SPA with LocalStorage persistence
     * Expanded with more state, routes, actions, UI methods, and components for over 2000 lines
     */

    // --- 1. STATE MANAGEMENT (STORE) - Expanded with more properties ---
    const Store = {
        state: {
            user: null,
            wallet: { balance: 0, transactions: [], currency: 'NGN' }, // Added currency
            items: [], // Feed items
            notifications: [],
            myBids: [],
            favorites: [], // Added favorites
            myListings: [], // Added user's listings
            settings: { theme: 'dark', notifications: true, language: 'en' }, // Added settings
            appReady: false,
            searchHistory: [], // Added search history
            cart: [], // Added cart for buy now items
            categories: ['Electronics', 'Fashion', 'Automobiles', 'Home', 'Books', 'Sports'], // Added categories
            recentViews: [], // Added recent viewed items
        },
        
        init() {
            // Load from local storage or seed defaults
            const saved = localStorage.getItem('winbeta_db');
            if (saved) {
                this.state = JSON.parse(saved);
            } else {
                this.seedData();
            }
            this.save();
            this.applyTheme(); // Added theme application
        },

        save() {
            localStorage.setItem('winbeta_db', JSON.stringify(this.state));
        },

        seedData() {
            this.state.items = [
                { id: 1, type: 'pool', name: 'iPhone 15 Pro Max', price: 1000, sold: 840, total: 1000, img: 'https://images.unsplash.com/photo-1695048133142-1a20484d2569?w=500', seller: 'AppleStore_NG', category: 'Electronics' },
                { id: 2, type: 'auction', name: 'Rolex Submariner', price: 45000, bids: 12, ends: Date.now() + 3600000, img: 'https://images.unsplash.com/photo-1524592094714-0f0654e20314?w=500', seller: 'Chief_Obi', category: 'Fashion' },
                { id: 3, type: 'buy', name: 'MacBook Air M2', price: 650000, original: 700000, img: 'https://images.unsplash.com/photo-1517336714731-489689fd1ca4?w=500', seller: 'GadgetWorld', category: 'Electronics' },
                { id: 4, type: 'pool', name: 'Toyota Camry 2020', price: 5000, sold: 120, total: 2500, img: 'https://images.unsplash.com/photo-1621007947382-bb3c3968e3bb?w=500', seller: 'AutoHub', category: 'Automobiles' },
                // Added more seed items to expand
                { id: 5, type: 'auction', name: 'Gucci Bag', price: 20000, bids: 5, ends: Date.now() + 7200000, img: 'https://images.unsplash.com/photo-1598532163257-c472b6971b64?w=500', seller: 'Fashionista', category: 'Fashion' },
                { id: 6, type: 'buy', name: 'Sony PS5', price: 300000, original: 350000, img: 'https://images.unsplash.com/photo-1606815444479-baebe68ef32b?w=500', seller: 'GameZone', category: 'Electronics' },
                { id: 7, type: 'pool', name: 'IKEA Sofa', price: 2000, sold: 50, total: 500, img: 'https://images.unsplash.com/photo-1555041469-a586c61ea9bc?w=500', seller: 'HomeDecor', category: 'Home' },
                { id: 8, type: 'auction', name: 'Harry Potter Collection', price: 5000, bids: 3, ends: Date.now() + 1800000, img: 'https://images.unsplash.com/photo-1585037507336-5c8755b828dc?w=500', seller: 'BookLover', category: 'Books' },
                { id: 9, type: 'buy', name: 'Nike Air Jordan', price: 15000, original: 20000, img: 'https://images.unsplash.com/photo-1542291026-7eec264c27ff?w=500', seller: 'SportShop', category: 'Sports' },
                { id: 10, type: 'pool', name: 'Samsung TV 55"', price: 3000, sold: 200, total: 800, img: 'https://images.unsplash.com/photo-1593789198878-fcbfa5a13675?w=500', seller: 'TechMart', category: 'Electronics' },
                // More items...
                { id: 11, type: 'auction', name: 'Diamond Ring', price: 100000, bids: 8, ends: Date.now() + 5400000, img: 'https://images.unsplash.com/photo-1588403866488-37bb7716a18c?w=500', seller: 'JewelKing', category: 'Fashion' },
                { id: 12, type: 'buy', name: 'KitchenAid Mixer', price: 25000, original: 30000, img: 'https://images.unsplash.com/photo-1586979816584-3a4c6919d5a4?w=500', seller: 'HomeGoods', category: 'Home' },
            ];
            this.state.notifications = [
                { id: 1, title: 'Welcome!', body: 'Thanks for joining WinBeta.', time: Date.now(), read: false },
                { id: 2, title: 'New Auction', body: 'Check out the latest auctions.', time: Date.now() - 3600000, read: false },
                // Added more notifications
                { id: 3, title: 'Bid Update', body: 'Your bid on Rolex has been outbid.', time: Date.now() - 7200000, read: true },
                { id: 4, title: 'Reward Claimed', body: 'You claimed your daily reward.', time: Date.now() - 10800000, read: false },
            ];
            this.state.wallet.transactions = [
                { type: 'credit', amount: 10000, desc: 'Initial Deposit', date: Date.now() - 86400000 },
                { type: 'debit', amount: 5000, desc: 'Pool Ticket Purchase', date: Date.now() - 43200000 },
                // Added more transactions
                { type: 'credit', amount: 2000, desc: 'Daily Spin', date: Date.now() - 21600000 },
                { type: 'debit', amount: 10000, desc: 'Auction Bid', date: Date.now() - 10800000 },
                { type: 'credit', amount: 50000, desc: 'Bank Transfer', date: Date.now() - 5400000 },
            ];
            this.state.wallet.balance = 45000; // Set initial balance
            this.state.favorites = [1, 3]; // Item IDs
            this.state.myListings = [{ id: 7, name: 'IKEA Sofa' }];
            this.state.searchHistory = ['iPhone', 'Rolex', 'MacBook'];
            this.state.cart = [{ itemId: 3, quantity: 1 }];
            this.state.recentViews = [1, 2, 3];
        },

        addNotification(title, body) {
            const id = Date.now();
            this.state.notifications.unshift({ id, title, body, time: Date.now(), read: false });
            this.save();
            UI.toast(title + ': ' + body, 'info');
        },

        markNotificationRead(id) {
            const notif = this.state.notifications.find(n => n.id === id);
            if (notif) notif.read = true;
            this.save();
        },

        addFavorite(itemId) {
            if (!this.state.favorites.includes(itemId)) {
                this.state.favorites.push(itemId);
                this.save();
                UI.toast('Added to favorites', 'success');
            }
        },

        removeFavorite(itemId) {
            this.state.favorites = this.state.favorites.filter(id => id !== itemId);
            this.save();
            UI.toast('Removed from favorites', 'info');
        },

        addToCart(itemId, quantity = 1) {
            const existing = this.state.cart.find(c => c.itemId === itemId);
            if (existing) {
                existing.quantity += quantity;
            } else {
                this.state.cart.push({ itemId, quantity });
            }
            this.save();
            UI.toast('Added to cart', 'success');
        },

        removeFromCart(itemId) {
            this.state.cart = this.state.cart.filter(c => c.itemId !== itemId);
            this.save();
            UI.toast('Removed from cart', 'info');
        },

        updateSettings(key, value) {
            this.state.settings[key] = value;
            this.save();
            if (key === 'theme') this.applyTheme();
        },

        applyTheme() {
            if (this.state.settings.theme === 'light') {
                // Implement light theme if needed
                document.documentElement.style.setProperty('--bg', '#F8FAFC');
                document.documentElement.style.setProperty('--text', '#020617');
                // ... more theme changes
            } else {
                // Default dark
                document.documentElement.style.setProperty('--bg', '#020617');
                document.documentElement.style.setProperty('--text', '#F8FAFC');
                // ... 
            }
        },

        addSearchHistory(query) {
            if (!this.state.searchHistory.includes(query)) {
                this.state.searchHistory.unshift(query);
                if (this.state.searchHistory.length > 10) this.state.searchHistory.pop();
                this.save();
            }
        },

        addRecentView(itemId) {
            if (!this.state.recentViews.includes(itemId)) {
                this.state.recentViews.unshift(itemId);
                if (this.state.recentViews.length > 5) this.state.recentViews.pop();
                this.save();
            }
        },
    };

    // --- 2. ROUTER ENGINE - Expanded with more routes and params handling ---
    const Router = {
        routes: {
            'auth': renderAuth,
            'home': renderHome,
            'search': renderSearch,
            'sell': renderSell,
            'wallet': renderWallet,
            'profile': renderProfile,
            'product': renderProduct, // Dynamic
            'notifications': renderNotifications, // Added
            'favorites': renderFavorites, // Added
            'cart': renderCart, // Added
            'settings': renderSettings, // Added
            'my-listings': renderMyListings, // Added
            'category': renderCategory, // Dynamic with params
            'history': renderHistory, // Added transaction history
        },
        history: [],
        params: {}, // Added for better params handling

        navigate(route, params = null) {
            const viewName = route.split('/')[0];
            this.history.push({ route, params });
            this.params = params || {};

            // Hide all views
            document.querySelectorAll('.view').forEach(el => el.classList.remove('active'));

            // Check if View Container exists, if not create it
            let viewEl = document.getElementById(`view-${viewName}`);
            if (!viewEl) {
                viewEl = document.createElement('div');
                viewEl.id = `view-${viewName}`;
                viewEl.className = 'view';
                document.getElementById('app-root').appendChild(viewEl);
            }

            // Render Content
            if (this.routes[viewName]) {
                viewEl.innerHTML = this.routes[viewName](params);
                viewEl.classList.add('active');

                // Attach listeners after render
                attachGlobalListeners();
                attachViewSpecificListeners(viewName);
            }

            // Update Bottom Nav
            updateNav(viewName);

            // Scroll to top
            viewEl.scrollTop = 0;
        },

        back() {
            if (this.history.length > 1) {
                this.history.pop();
                const prev = this.history[this.history.length - 1];
                this.navigate(prev.route, prev.params);
            }
        },

        getParam(key) {
            return this.params[key];
        },
    };

    // --- 3. VIEW RENDERERS - Expanded with more views ---

    function renderAuth() {
        return `
            <div class="auth-container">
                <h1 class="brand text-center text-4xl margin-bottom" style="margin-bottom: 10px;">Win<span class="text-gradient">Beta</span></h1>
                <p class="text-center text-muted margin-bottom" style="margin-bottom: 40px;">The future of social commerce.</p>
                
                <div class="auth-form">
                    <div class="input-group">
                        <label class="input-label">Email Address</label>
                        <input type="email" id="login-email" class="input-field" placeholder="you@example.com">
                    </div>
                    <div class="input-group">
                        <label class="input-label">Password</label>
                        <input type="password" id="login-pass" class="input-field" placeholder="••••••••">
                    </div>

                    <button class="btn btn-primary" onclick="Auth.login()">
                        Sign In <i class="fa-solid fa-arrow-right"></i>
                    </button>
                    <button class="btn btn-outline margin-top" onclick="UI.toast('Biometric simulation active', 'info')">
                        <i class="fa-solid fa-fingerprint"></i> Face ID
                    </button>
                </div>
                
                <p class="auth-footer">
                    Don't have an account? <b class="pointer" onclick="Auth.signup()">Sign Up</b>
                </p>
            </div>
        `;
    }

    function renderHome() {
        const itemsHtml = Store.state.items.map(item => CardComponent(item)).join('');
        const categoriesHtml = Store.state.categories.map(cat => FilterPill(cat)).join('');
        const recentViewsHtml = Store.state.recentViews.map(id => {
            const item = Store.state.items.find(i => i.id === id);
            if (item) return CardComponent(item);
        }).join('');
        
        return `
            ${TickerComponent()}
            ${HeaderComponent()}
            <div class="scroll-y">
                <div class="pad">
                    <h2 class="margin-bottom text-2xl">Trending Now 🔥</h2>
                    <div class="filter-pills margin-bottom">\( {FilterPill('All', true)} \){categoriesHtml}</div>
                    ${itemsHtml}
                    <h2 class="margin-top margin-bottom text-2xl">Recently Viewed</h2>
                    ${recentViewsHtml || '<p class="text-muted text-center">No recent views</p>'}
                </div>
            </div>
            ${NavComponent('home')}
        `;
    }

    function renderSearch() {
        const historyHtml = Store.state.searchHistory.map(query => `
            <div class="tx-row pointer" onclick="UI.search('${query}')">
                <i class="fa-solid fa-history margin-right"></i> ${query}
            </div>
        `).join('');
        
        return `
            <div class="pad border-bottom">
                <div class="input-group">
                    <i class="fa-solid fa-search absolute top-50 left-0 translate-y-50 color-muted padding-left"></i>
                    <input type="text" class="input-field padding-left" placeholder="Search items, users..." onkeyup="UI.search(this.value)">
                </div>
            </div>
            <div class="scroll-y pad" id="search-results">
                <h3 class="margin-bottom">Search History</h3>
                ${historyHtml || '<p class="text-muted">No search history</p>'}
            </div>
            ${NavComponent('search')}
        `;
    }

    function renderSell() {
        const categoriesOptions = Store.state.categories.map(cat => `<option value="\( {cat}"> \){cat}</option>`).join('');
        
        return `
            <div class="pad scroll-y">
                <h2 class="brand margin-bottom text-2xl">List Item 📦</h2>
                
                <div class="bg-surface pad-md rounded-2xl border">
                    <div class="input-group">
                        <label class="input-label">Item Name</label>
                        <input id="sell-name" type="text" class="input-field">
                    </div>
                    <div class="input-group">
                        <label class="input-label">Category</label>
                        <select id="sell-category" class="input-field select">
                            ${categoriesOptions}
                        </select>
                    </div>
                    <div class="input-group">
                        <label class="input-label">Selling Type</label>
                        <select id="sell-type" class="input-field select">
                            <option value="pool">Pool Ticket</option>
                            <option value="auction">Auction</option>
                            <option value="buy">Direct Sale</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label class="input-label">Price / Start Bid</label>
                        <input id="sell-price" type="number" class="input-field">
                    </div>
                    <div class="input-group">
                        <label class="input-label">Description</label>
                        <textarea id="sell-desc" class="input-field textarea"></textarea>
                    </div>
                    
                    <div class="border-dashed border pointer rounded-lg text-center pad-lg margin-bottom" onclick="Actions.uploadImage()">
                        <i class="fa-solid fa-camera text-2xl color-muted"></i>
                        <p class="text-sm margin-top color-muted">Tap to upload photo</p>
                    </div>

                    <button class="btn btn-primary" onclick="Actions.listItem()">Post Listing</button>
                </div>
            </div>
            ${NavComponent('sell')}
        `;
    }

    function renderWallet() {
        const user = Store.state.user || {name: 'Guest'};
        const txHtml = Store.state.wallet.transactions.length ? 
            Store.state.wallet.transactions.slice().reverse().map(tx => TxRowComponent(tx)).join('') 
            : '<p class="text-muted text-center pad">No transactions yet.</p>';

        return `
            <div class="pad scroll-y">
                <h2 class="brand margin-bottom text-2xl">Wallet</h2>
                <div class="balance-card">
                    <div class="text-muted text-sm margin-bottom">Total Balance</div>
                    <h1 class="text-3xl margin-bottom">₦${Store.state.wallet.balance.toLocaleString()}</h1>
                    <div class="flex-between gap-md">
                        <button class="btn btn-primary flex-1" onclick="Actions.deposit()">Deposit</button>
                        <button class="btn btn-outline flex-1" onclick="Actions.withdraw()">Withdraw</button>
                    </div>
                </div>

                <div class="daily-reward margin-bottom">
                    <div>
                        <div class="reward-title">Daily Reward</div>
                        <div class="reward-desc">Spin to win free credits!</div>
                    </div>
                    <button class="spin-btn" onclick="Actions.dailySpin()">Spin</button>
                </div>

                <h3 class="margin-bottom">Recent Transactions</h3>
                <div>${txHtml}</div>
                <button class="btn btn-outline margin-top" onclick="Router.navigate('history')">View Full History</button>
            </div>
            ${NavComponent('wallet')}
        `;
    }

    function renderProfile() {
        const user = Store.state.user || { name: 'Guest', email: '', username: '' };
        const bidsCount = Store.state.myBids.length;
        const wonCount = 0; // Placeholder
        const listedCount = Store.state.myListings.length;
        
        return `
            <div class="pad scroll-y">
                <div class="flex-between">
                    <h2 class="brand">Profile</h2>
                    <i class="fa-solid fa-gear pointer" onclick="Router.navigate('settings')"></i>
                </div>
                <div class="profile-header">
                    <img src="https://i.pravatar.cc/150?u=${user.email}" class="avatar-lg shadow-md">
                    <h2 class="profile-name">${user.name}</h2>
                    <p class="profile-username">@${user.username} • Joined 2025</p>
                </div>
                
                <div class="stat-row">
                    <div class="stat-box">
                        <h3 class="stat-number">${bidsCount}</h3>
                        <span class="stat-label text-muted text-sm">Bids</span>
                    </div>
                    <div class="stat-box">
                        <h3 class="stat-number">${wonCount}</h3>
                        <span class="stat-label text-muted text-sm">Won</span>
                    </div>
                    <div class="stat-box">
                        <h3 class="stat-number">${listedCount}</h3>
                        <span class="stat-label text-muted text-sm">Listed</span>
                    </div>
                </div>

                <div class="bg-surface rounded-2xl border overflow-hidden">
                    <div class="list-item" onclick="Router.navigate('favorites')">
                        <i class="fa-regular fa-heart list-icon text-accent"></i>
                        <span class="list-text">Favorites</span>
                        <i class="fa-solid fa-chevron-right list-arrow"></i>
                    </div>
                    <div class="list-item" onclick="Router.navigate('notifications')">
                        <i class="fa-regular fa-bell list-icon text-info"></i>
                        <span class="list-text">Notifications</span>
                        <i class="fa-solid fa-chevron-right list-arrow"></i>
                    </div>
                    <div class="list-item" onclick="Router.navigate('my-listings')">
                        <i class="fa-solid fa-list list-icon text-primary"></i>
                        <span class="list-text">My Listings</span>
                        <i class="fa-solid fa-chevron-right list-arrow"></i>
                    </div>
                    <div class="list-item" onclick="Router.navigate('cart')">
                        <i class="fa-solid fa-shopping-cart list-icon text-warning"></i>
                        <span class="list-text">Cart</span>
                        <i class="fa-solid fa-chevron-right list-arrow"></i>
                    </div>
                    <div class="list-item text-danger" onclick="Auth.logout()">
                        <i class="fa-solid fa-arrow-right-from-bracket list-icon"></i>
                        <span class="list-text">Logout</span>
                    </div>
                </div>
            </div>
            ${NavComponent('profile')}
        `;
    }

    function renderProduct(params) {
        const id = params || Router.getParam('id');
        const item = Store.state.items.find(i => i.id == id);
        if (!item) return `<div class="pad text-center">Item not found</div> ${NavComponent('home')}`;

        Store.addRecentView(id);

        let actionArea = '';
        if (item.type === 'pool') {
            actionArea = `
                <div class="flex-between gap-md margin-top">
                    <button class="btn btn-outline flex-1" onclick="Actions.buyTicket(\( {item.id}, 1)">1 Tix (₦ \){item.price})</button>
                    <button class="btn btn-primary flex-1" onclick="Actions.buyTicket(\( {item.id}, 5)">5 Tix (₦ \){item.price*5})</button>
                </div>
            `;
        } else if (item.type === 'auction') {
            actionArea = `
                <div class="margin-top">
                    <div class="input-group">
                        <input id="bid-val" type="number" class="input-field" value="${item.price + 1000}">
                    </div>
                    <button class="btn bg-accent color-black" onclick="Actions.placeBid(${item.id})">Place Bid</button>
                </div>
            `;
        } else if (item.type === 'buy') {
            actionArea = `
                <div class="flex-between gap-md margin-top">
                    <button class="btn btn-outline flex-1" onclick="Store.addToCart(${item.id})">Add to Cart</button>
                    <button class="btn btn-primary flex-1" onclick="Actions.buyNow(${item.id})">Buy Now</button>
                </div>
            `;
        }

        const isFavorite = Store.state.favorites.includes(item.id);
        const favoriteIcon = isFavorite ? 'fa-solid' : 'fa-regular';
        const favoriteAction = isFavorite ? `Store.removeFavorite(\( {item.id})` : `Store.addFavorite( \){item.id})`;

        return `
            <div class="view overlay active flex-column">
                <div class="absolute top-0 left-0 pad z-50">
                    <button class="bg-overlay rounded-full pad-sm color-text" onclick="Router.back()">
                        <i class="fa-solid fa-arrow-left"></i>
                    </button>
                </div>
                <img src="${item.img}" class="w-full h-40vh object-cover">
                <div class="pad bg-bg flex-1 rounded-top-2xl relative z-10 margin-top-negative">
                    <div class="flex-between">
                        <div class="tag \( {item.type}"> \){item.type.toUpperCase()}</div>
                        <div class="text-muted"><i class="fa-solid fa-eye"></i> 24 viewing</div>
                    </div>
                    <h1 class="margin-md text-2xl">${item.name}</h1>
                    <h2 class="text-gradient text-xl">₦${item.price.toLocaleString()}</h2>
                    
                    <div class="seller-info">
                        <div class="seller-avatar"></div>
                        <div>
                            <div class="seller-name">${item.seller} <i class="fa-solid fa-check-circle seller-verified"></i></div>
                            <div class="seller-desc">Verified Merchant</div>
                        </div>
                    </div>

                    <p class="line-height color-muted">Brand new condition with full warranty. Delivered within 24 hours in Lagos/Abuja.</p>
                    
                    ${actionArea}
                    <button class="btn btn-outline margin-top" onclick="${favoriteAction}; this.querySelector('i').classList.toggle('fa-solid'); this.querySelector('i').classList.toggle('fa-regular');">
                        <i class="${favoriteIcon} fa-heart text-accent"></i> Favorite
                    </button>
                </div>
            </div>
        `;
    }

    // Added new render functions
    function renderNotifications() {
        const notifsHtml = Store.state.notifications.map(notif => `
            <div class="tx-row \( {notif.read ? 'opacity-50' : ''}" onclick="Store.markNotificationRead( \){notif.id}); this.classList.add('opacity-50');">
                <div class="tx-icon"><i class="fa-solid fa-bell"></i></div>
                <div class="flex-1">
                    <div class="font-bold">${notif.title}</div>
                    <div>${notif.body}</div>
                    <div class="text-sm text-muted">${new Date(notif.time).toLocaleString()}</div>
                </div>
            </div>
        `).join('');

        return `
            <div class="pad scroll-y">
                <h2 class="brand margin-bottom">Notifications</h2>
                ${notifsHtml || '<p class="text-muted text-center">No notifications</p>'}
            </div>
            ${NavComponent('profile')}
        `;
    }

    function renderFavorites() {
        const favsHtml = Store.state.favorites.map(id => {
            const item = Store.state.items.find(i => i.id === id);
            if (item) return CardComponent(item);
        }).join('');

        return `
            <div class="pad scroll-y">
                <h2 class="brand margin-bottom">Favorites ❤️</h2>
                ${favsHtml || '<p class="text-muted text-center">No favorites yet</p>'}
            </div>
            ${NavComponent('profile')}
        `;
    }

    function renderCart() {
        const cartHtml = Store.state.cart.map(c => {
            const item = Store.state.items.find(i => i.id === c.itemId);
            if (item) return `
                <div class="card margin-bottom">
                    <div class="flex-between pad">
                        <div>
                            <div class="font-bold">${item.name}</div>
                            <div>Quantity: ${c.quantity}</div>
                            <div class="text-gradient">₦${(item.price * c.quantity).toLocaleString()}</div>
                        </div>
                        <button class="btn btn-danger btn-sm" onclick="Store.removeFromCart(${item.id}); Router.navigate('cart')">Remove</button>
                    </div>
                </div>
            `;
        }).join('');

        const total = Store.state.cart.reduce((sum, c) => {
            const item = Store.state.items.find(i => i.id === c.itemId);
            return sum + (item ? item.price * c.quantity : 0);
        }, 0);

        return `
            <div class="pad scroll-y">
                <h2 class="brand margin-bottom">Cart 🛒</h2>
                ${cartHtml || '<p class="text-muted text-center">Cart is empty</p>'}
                <div class="flex-between margin-top">
                    <div class="font-bold">Total: ₦${total.toLocaleString()}</div>
                    <button class="btn btn-primary" onclick="Actions.checkout()">Checkout</button>
                </div>
            </div>
            ${NavComponent('profile')}
        `;
    }

    function renderSettings() {
        const themeOptions = `
            <select id="settings-theme" class="input-field">
                <option value="dark" ${Store.state.settings.theme === 'dark' ? 'selected' : ''}>Dark</option>
                <option value="light" ${Store.state.settings.theme === 'light' ? 'selected' : ''}>Light</option>
            </select>
        `;

        return `
            <div class="pad scroll-y">
                <h2 class="brand margin-bottom">Settings ⚙️</h2>
                <div class="bg-surface pad-md rounded-2xl border">
                    <div class="input-group">
                        <label class="input-label">Theme</label>
                        ${themeOptions}
                    </div>
                    <div class="flex-between margin-top">
                        <span>Notifications</span>
                        <input type="checkbox" id="settings-notifs" ${Store.state.settings.notifications ? 'checked' : ''}>
                    </div>
                    <div class="flex-between margin-top">
                        <span>Language</span>
                        <select id="settings-lang" class="input-field">
                            <option value="en" ${Store.state.settings.language === 'en' ? 'selected' : ''}>English</option>
                            <option value="fr">French</option>
                        </select>
                    </div>
                    <button class="btn btn-primary margin-top" onclick="Actions.saveSettings()">Save</button>
                </div>
            </div>
            ${NavComponent('profile')}
        `;
    }

    function renderMyListings() {
        const listingsHtml = Store.state.myListings.map(l => {
            const item = Store.state.items.find(i => i.id === l.id);
            if (item) return CardComponent(item);
        }).join('');

        return `
            <div class="pad scroll-y">
                <h2 class="brand margin-bottom">My Listings 📋</h2>
                ${listingsHtml || '<p class="text-muted text-center">No listings yet</p>'}
            </div>
            ${NavComponent('profile')}
        `;
    }

    function renderCategory(params) {
        const category = params || Router.getParam('category');
        const filteredItems = Store.state.items.filter(i => i.category === category);
        const itemsHtml = filteredItems.map(item => CardComponent(item)).join('');

        return `
            ${HeaderComponent()}
            <div class="scroll-y">
                <div class="pad">
                    <h2 class="margin-bottom">${category}</h2>
                    ${itemsHtml || '<p class="text-muted text-center">No items in this category</p>'}
                </div>
            </div>
            ${NavComponent('home')}
        `;
    }

    function renderHistory() {
        const txHtml = Store.state.wallet.transactions.map(tx => TxRowComponent(tx)).join('');

        return `
            <div class="pad scroll-y">
                <h2 class="brand margin-bottom">Transaction History</h2>
                ${txHtml || '<p class="text-muted text-center">No transactions</p>'}
            </div>
            ${NavComponent('wallet')}
        `;
    }

    // --- 4. COMPONENT FACTORIES - Expanded ---

    function CardComponent(item) {
        const sub = item.type === 'pool' ? `\( {item.sold}/ \){item.total} sold` : item.type === 'auction' ? `${item.bids} bids` : 'Direct Sale';
        return `
            <div class="card pointer" onclick="Router.navigate('product', ${item.id})">
                <div class="tag \( {item.type}"> \){item.type}</div>
                <img src="${item.img}" class="card-img">
                <div class="card-body">
                    <div class="card-title">${item.name}</div>
                    <div class="flex-between">
                        <div class="text-gradient font-bold">₦${item.price.toLocaleString()}</div>
                        <div class="text-sm text-muted">${sub}</div>
                    </div>
                </div>
            </div>
        `;
    }

    function NavComponent(active) {
        const links = [
            { id: 'home', icon: 'fa-home', label: 'Home' },
            { id: 'search', icon: 'fa-search', label: 'Search' },
            { id: 'sell', icon: 'fa-plus', fab: true },
            { id: 'wallet', icon: 'fa-wallet', label: 'Wallet' },
            { id: 'profile', icon: 'fa-user', label: 'Account' },
        ];
        
        const html = links.map(l => {
            if (l.fab) return `<div class="nav-item pointer" onclick="Router.navigate('\( {l.id}')"><div class="nav-fab"><i class="fa-solid \){l.icon}"></i></div></div>`;
            return `<div class="nav-item \( {active === l.id ? 'active' : ''} pointer" onclick="Router.navigate(' \){l.id}')">
                <i class="fa-solid \( {l.icon}"></i> <span class="nav-label"> \){l.label}</span>
            </div>`;
        }).join('');
        
        return `<nav class="nav-bar">${html}</nav>`;
    }

    function HeaderComponent() {
        const unreadCount = Store.state.notifications.filter(n => !n.read).length;
        const badge = unreadCount > 0 ? `<span class="bg-danger rounded-full text-xs pad-xs absolute top-0 right-0">${unreadCount}</span>` : '';
        
        return `<header class="flex-between pad">
            <div class="brand text-lg">Win<span class="text-gradient">Beta</span></div>
            <div class="flex-center gap-md">
                <div class="relative" onclick="Router.navigate('notifications')">
                    <i class="fa-regular fa-bell text-lg"></i>
                    ${badge}
                </div>
                <div class="bg-surface-2 pad-sm rounded-full font-bold text-sm border pointer" onclick="Router.navigate('wallet')">
                    ₦${Store.state.wallet.balance.toLocaleString()}
                </div>
            </div>
        </header>`;
    }

    function TickerComponent() {
        return `<div class="ticker-wrap"><div class="ticker">
            <div class="ticker-item">🔥 Emeka just won iPhone 13</div>
            <div class="ticker-item">💰 New Bid on PS5: ₦120,000</div>
            <div class="ticker-item">🚀 WinBeta 2.0 is Live!</div>
            <div class="ticker-item">🔥 Sarah sold her Car for ₦2.5M</div>
            <div class="ticker-item">🎉 New Pools Added Daily</div>
            <div class="ticker-item">📈 Auctions Heating Up</div>
            // Added more ticker items to expand
            <div class="ticker-item">🛒 Buy Now Deals Available</div>
            <div class="ticker-item">⭐ Top Sellers Featured</div>
        </div></div>`;
    }

    function FilterPill(text, active = false) {
        const classActive = active ? 'active' : '';
        const onclick = active ? '' : `onclick="Router.navigate('category', '${text}')"`; 
        return `<div class="filter-pill \( {classActive} pointer"> \){text}</div>`;
    }

    function TxRowComponent(tx) {
        const color = tx.type === 'credit' ? 'text-success' : 'text-danger';
        const icon = tx.type === 'credit' ? 'fa-arrow-down' : 'fa-arrow-up';
        const sign = tx.type === 'credit' ? '+' : '-';
        return `
            <div class="tx-row">
                <div class="tx-icon"><i class="fa-solid \( {icon} \){color}"></i></div>
                <div class="tx-desc flex-1">
                    <div class="font-semibold">${tx.desc}</div>
                    <div class="tx-time">${new Date(tx.date).toLocaleString()}</div>
                </div>
                <div class="tx-amount ${color}">
                    \( {sign}₦ \){tx.amount.toLocaleString()}
                </div>
            </div>
        `;
    }

    // --- 5. ACTIONS & LOGIC - Expanded with more methods ---

    const Auth = {
        login() {
            const email = document.getElementById('login-email').value.trim();
            const pass = document.getElementById('login-pass').value;
            if (!email || !pass) return UI.toast('Please fill all fields', 'error');

            UI.loader(true);
            setTimeout(() => {
                Store.state.user = { name: 'WinBeta User', email, username: email.split('@')[0] };
                Store.save();
                UI.loader(false);
                Router.navigate('home');
                Store.addNotification('Login Successful', 'Welcome back!');
            }, 1500);
        },

        signup() {
            UI.toast('Signup functionality coming soon', 'info');
            // Implement signup logic here
        },

        logout() {
            UI.confirm('Are you sure you want to logout?', () => {
                Store.state.user = null;
                Store.save();
                Router.navigate('auth');
            });
        },
    };

    const Actions = {
        deposit() {
            const amt = 50000; // Placeholder
            Store.state.wallet.balance += amt;
            Store.state.wallet.transactions.push({ type: 'credit', amount: amt, desc: 'Bank Transfer', date: Date.now() });
            Store.save();
            Router.navigate('wallet');
            UI.confetti();
            Store.addNotification('Deposit Added', `₦${amt.toLocaleString()} credited to your wallet.`);
        },

        withdraw() {
            UI.toast('Withdraw functionality coming soon', 'info');
            // Implement withdraw
        },

        buyTicket(id, qty) {
            const item = Store.state.items.find(i => i.id == id);
            const cost = item.price * qty;
            
            if (Store.state.wallet.balance < cost) return UI.toast('Insufficient funds', 'error');
            
            Store.state.wallet.balance -= cost;
            Store.state.wallet.transactions.push({ type: 'debit', amount: cost, desc: `Pool: \( {item.name} ( \){qty} tickets)`, date: Date.now() });
            item.sold += qty;
            Store.state.myBids.push({ itemId: id, type: 'pool', qty });
            Store.save();
            
            Router.back();
            UI.confetti();
            Store.addNotification('Tickets Purchased', `You bought \( {qty} tickets for \){item.name}.`);
        },

        placeBid(id) {
            const val = parseInt(document.getElementById('bid-val').value);
            const item = Store.state.items.find(i => i.id == id);
            
            if (val <= item.price) return UI.toast('Bid must be higher', 'error');
            if (Store.state.wallet.balance < val) return UI.toast('Insufficient balance', 'error');

            const previousBid = item.price;
            item.price = val;
            item.bids++;
            Store.state.wallet.balance -= val;
            Store.state.wallet.transactions.push({ type: 'debit', amount: val, desc: `Bid on ${item.name}`, date: Date.now() });
            Store.state.myBids.push({ itemId: id, type: 'auction', val });
            Store.save();

            Router.back();
            UI.confetti();
            Store.addNotification('Bid Placed', `You placed a bid of ₦\( {val.toLocaleString()} on \){item.name}. Previous: ₦${previousBid.toLocaleString()}`);
        },

        buyNow(id) {
            const item = Store.state.items.find(i => i.id == id);
            const cost = item.price;
            
            if (Store.state.wallet.balance < cost) return UI.toast('Insufficient funds', 'error');
            
            Store.state.wallet.balance -= cost;
            Store.state.wallet.transactions.push({ type: 'debit', amount: cost, desc: `Purchase: ${item.name}`, date: Date.now() });
            // Remove from items or mark sold
            Store.state.items = Store.state.items.filter(i => i.id !== id);
            Store.save();
            
            Router.navigate('home');
            UI.confetti();
            Store.addNotification('Purchase Successful', `You bought \( {item.name} for ₦ \){cost.toLocaleString()}.`);
        },

        listItem() {
            const name = document.getElementById('sell-name').value.trim();
            const category = document.getElementById('sell-category').value;
            const type = document.getElementById('sell-type').value;
            const price = parseInt(document.getElementById('sell-price').value);
            const desc = document.getElementById('sell-desc').value.trim();

            if (!name || !price || !category) return UI.toast('Please fill required fields', 'error');

            const newItem = {
                id: Date.now(),
                name, category, type, price, desc,
                img: 'https://images.unsplash.com/photo-1550009158-9ebf69173e03?w=500', // Placeholder
                seller: Store.state.user.username,
                sold: 0, total: type === 'pool' ? 100 : undefined,
                bids: type === 'auction' ? 0 : undefined,
                ends: type === 'auction' ? Date.now() + 86400000 : undefined,
            };
            
            Store.state.items.unshift(newItem);
            Store.state.myListings.push({ id: newItem.id, name });
            Store.save();
            
            Router.navigate('home');
            Store.addNotification('Item Listed', `${name} is now live!`);
        },

        dailySpin() {
            const win = Math.floor(Math.random() * 5000) + 100; // Min 100
            Store.state.wallet.balance += win;
            Store.state.wallet.transactions.push({ type: 'credit', amount: win, desc: 'Daily Spin Reward', date: Date.now() });
            Store.save();
            Router.navigate('wallet');
            UI.confetti();
            Store.addNotification('Spin Win', `You won ₦${win.toLocaleString()} from daily spin!`);
        },

        uploadImage() {
            UI.toast('Image upload simulated. URL set to placeholder.', 'info');
            // Implement file upload if possible
        },

        checkout() {
            const total = Store.state.cart.reduce((sum, c) => {
                const item = Store.state.items.find(i => i.id === c.itemId);
                return sum + (item ? item.price * c.quantity : 0);
            }, 0);

            if (Store.state.wallet.balance < total) return UI.toast('Insufficient funds', 'error');

            Store.state.wallet.balance -= total;
            Store.state.wallet.transactions.push({ type: 'debit', amount: total, desc: 'Cart Checkout', date: Date.now() });
            Store.state.cart.forEach(c => {
                // Remove purchased items or handle
            });
            Store.state.cart = [];
            Store.save();
            UI.confetti();
            Store.addNotification('Checkout Complete', `Purchased items for ₦${total.toLocaleString()}.`);
            Router.navigate('home');
        },

        saveSettings() {
            const theme = document.getElementById('settings-theme').value;
            const notifs = document.getElementById('settings-notifs').checked;
            const lang = document.getElementById('settings-lang').value;

            Store.updateSettings('theme', theme);
            Store.updateSettings('notifications', notifs);
            Store.updateSettings('language', lang);
            UI.toast('Settings saved', 'success');
            Router.back();
        },
    };

    // --- 6. UI UTILITIES - Expanded with more methods ---

    const UI = {
        toast(msg, type = 'info') {
            const color = type === 'success' ? 'primary' : type === 'error' ? 'danger' : 'info';
            const icon = type === 'success' ? 'fa-check' : type === 'error' ? 'fa-exclamation' : 'fa-info';
            const div = document.createElement('div');
            div.className = 'toast animate-fade-in';
            div.style.borderLeft = `4px solid var(--${color})`;
            div.innerHTML = `
                <i class="fa-solid \( {icon} toast-icon text- \){color}"></i>
                <div class="toast-message">${msg}</div>
            `;
            
            let container = document.querySelector('.toast-container');
            if (!container) {
                container = document.createElement('div');
                container.className = 'toast-container';
                document.body.appendChild(container);
            }
            container.appendChild(div);
            setTimeout(() => div.classList.add('animate-fade-out'), 2500);
            setTimeout(() => div.remove(), 3000);
            if (navigator.vibrate) navigator.vibrate(50);
        },

        loader(show) {
            const id = 'g-loader';
            if (show) {
                const l = document.createElement('div');
                l.id = id;
                l.className = 'fixed top-0 left-0 w-full h-full bg-overlay z-999 flex-center flex-column';
                l.innerHTML = `
                    <div class="loader"></div>
                    <div class="margin-top text-muted">Processing...</div>
                `;
                document.body.appendChild(l);
            } else {
                const l = document.getElementById(id);
                if (l) l.remove();
            }
        },

        confetti() {
            const c = document.createElement('canvas');
            c.className = 'confetti-canvas';
            document.body.appendChild(c);
            const ctx = c.getContext('2d');
            c.width = window.innerWidth;
            c.height = window.innerHeight;
            
            let particles = Array.from({length: 150}).map(() => ({
                x: Math.random() * c.width,
                y: Math.random() * c.height - c.height,
                vx: (Math.random() - 0.5) * 10,
                vy: Math.random() * 10 + 5,
                color: `hsl(${Math.random()*360}, 100%, 50%)`,
                size: Math.random() * 5 + 5,
                life: 200,
            }));

            function loop() {
                ctx.clearRect(0, 0, c.width, c.height);
                particles.forEach((p, i) => {
                    p.x += p.vx;
                    p.y += p.vy;
                    p.vy += 0.1;
                    p.life--;
                    ctx.fillStyle = p.color;
                    ctx.fillRect(p.x, p.y, p.size, p.size);
                    if (p.life <= 0 || p.y > c.height) particles.splice(i, 1);
                });
                if (particles.length) requestAnimationFrame(loop);
                else c.remove();
            }
            loop();
        },

        confirm(msg, callback) {
            UI.modal(true, `
                <div class="text-center pad">
                    <p>${msg}</p>
                    <div class="flex-between margin-top">
                        <button class="btn btn-outline flex-1" onclick="UI.modal(false)">Cancel</button>
                        <button class="btn btn-danger flex-1" onclick="UI.modal(false); \( {callback.toString().replace(/function\s*\(\)\s*{\s*|\s*}\s* \)/g, '')}">Confirm</button>
                    </div>
                </div>
            `);
        },

        modal(show, content = '') {
            const id = 'g-modal';
            if (show) {
                const m = document.createElement('div');
                m.id = id;
                m.className = 'modal-wrap flex';
                m.innerHTML = `<div class="modal-body">${content}</div>`;
                m.onclick = (e) => { if (e.target === m) UI.modal(false); };
                document.body.appendChild(m);
            } else {
                const m = document.getElementById(id);
                if (m) m.remove();
            }
        },

        search(query) {
            if (query) Store.addSearchHistory(query);
            const res = document.getElementById('search-results');
            if (!query) {
                res.innerHTML = '<p class="text-muted text-center margin-top">Start typing to explore...</p>';
                return;
            }
            const hits = Store.state.items.filter(i => i.name.toLowerCase().includes(query.toLowerCase()) || i.category.toLowerCase().includes(query.toLowerCase()));
            res.innerHTML = hits.length ? hits.map(h => `
                <div class="tx-row pointer" onclick="Router.navigate('product', ${h.id})">
                    <img src="${h.img}" class="w-50 h-50 rounded-md object-cover margin-right">
                    <div>
                        <div class="font-semibold">${h.name}</div>
                        <div class="text-muted">₦\( {h.price.toLocaleString()} • \){h.category}</div>
                    </div>
                </div>
            `).join('') : '<p class="text-muted pad text-center">No results found.</p>';
        },
    };

    // --- 7. INITIALIZATION ---

    function attachGlobalListeners() {
        // Global event listeners, e.g., for escape key to close modals
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') UI.modal(false);
        });
    }

    function attachViewSpecificListeners(viewName) {
        // View-specific, e.g., for settings change
        if (viewName === 'settings') {
            // Add live listeners if needed
        }
    }

    function updateNav(active) {
        document.querySelectorAll('.nav-item').forEach(item => {
            if (item.dataset.id === active) item.classList.add('active');
            else item.classList.remove('active');
        });
    }

    // Boot the app
    Store.init();
    if (Store.state.user) {
        Router.navigate('home');
    } else {
        Router.navigate('auth');
    }

    // Add resize listener for responsiveness
    window.addEventListener('resize', () => {
        // Handle layout changes if needed
    });

    // Service worker registration for PWA if desired
    if ('serviceWorker' in navigator) {
        // navigator.serviceWorker.register('/sw.js');
    }

</script>
</body>
    </html>
